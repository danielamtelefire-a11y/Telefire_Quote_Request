<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Telefire – בקשת הצעת מחיר</title>
  <style>
    :root{--brand-red:#d62828;--bg:#f7f7f8;--card:#fff;--ink:#0f172a;--muted:#6b7280;--border:#e5e7eb;--shadow:0 8px 24px rgba(0,0,0,.08)}
    html,body{height:100%;-webkit-text-size-adjust:100%}
    body{margin:0;background:var(--bg);color:var(--ink);font-family:Heebo,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial}
    body::before{content:"";position:fixed;inset:0;background:url('background.png') center/cover no-repeat;opacity:.07;pointer-events:none;z-index:0}
    .container{position:relative;z-index:1;max-width:1024px;margin:20px auto;padding:0 16px}
    header{display:flex;align-items:center;justify-content:space-between;gap:16px;background:rgba(255,255,255,.9);backdrop-filter:blur(6px);border:1px solid var(--border);border-radius:16px;padding:12px 16px;box-shadow:var(--shadow)}
    .brand{display:flex;align-items:center;gap:12px}
    .brand img{height:44px;width:auto;object-fit:contain}
    .title{font-weight:800;letter-spacing:.2px}
    .badge{font-weight:700;color:#fff;background:var(--brand-red);padding:6px 10px;border-radius:999px;font-size:.9rem}
    .card{margin-top:14px;background:var(--card);border:1px solid var(--border);border-radius:18px;padding:18px;box-shadow:var(--shadow)}
    h1{font-size:1.35rem;margin:0 0 8px} h2{font-size:1.05rem;margin:20px 0 10px;color:var(--brand-red)}
    label{display:block;font-weight:600;margin:8px 0 6px}
    input,select,textarea,button{width:100%;box-sizing:border-box;padding:12px 14px;border:1px solid var(--border);border-radius:12px;font-size:16px;background:#fff}
    textarea{min-height:96px;resize:vertical}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
    .col-12{grid-column:span 12}.col-6{grid-column:span 6}.col-4{grid-column:span 4}.col-3{grid-column:span 3}
    @media (max-width:768px){.col-6,.col-4,.col-3{grid-column:span 12}h1{font-size:1.2rem}h2{font-size:1rem;margin-top:16px}}
    .checkboxes{display:flex;flex-wrap:wrap;gap:10px}
    .chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:#fff;cursor:pointer}
    .muted{color:var(--muted);font-size:.92rem}
    .actions{display:flex;gap:10px;margin-top:16px}
    .actions button{cursor:pointer} .primary{background:var(--brand-red);color:#fff} .ghost{background:#f1f2f5}
    table{width:100%;border-collapse:collapse;background:#fff} th,td{border:1px solid var(--border);padding:8px 10px;text-align:right} th{background:#f8fafc}
    .required::after{content:" *";color:var(--brand-red)} .footer{margin-top:14px;font-size:.85rem;color:var(--muted)}
    @media (max-width:768px){
      table.responsive{border:0}
      table.responsive thead{display:none}
      table.responsive,table.responsive tbody,table.responsive tr,table.responsive td{display:block;width:100%}
      table.responsive tr{background:#fff;border:1px solid var(--border);border-radius:12px;padding:8px 10px;margin-bottom:10px}
      table.responsive td{border:0;padding:8px 0;display:flex;gap:8px;justify-content:space-between;align-items:flex-start}
      table.responsive td::before{content:attr(data-label);font-weight:700;color:#444}
      .actions{flex-direction:column}.actions button{width:100%}
    }
    .yn{display:flex;gap:8px;flex-wrap:wrap}
    .yn input{display:none}
    .yn label{padding:8px 12px;border:1px solid var(--border);border-radius:999px;cursor:pointer;background:#fff}
    .yn input:checked+label{border-color:var(--brand-red);box-shadow:0 0 0 2px rgba(214,40,40,.15)}
    .yn label::before{content:"";display:inline-block;width:1em;height:1em;margin-left:6px;border:1px solid #cbd5e1;border-radius:4px;vertical-align:-2px}
    .yn input:checked+label::before{content:"✔";display:inline-grid;place-items:center;border-color:var(--brand-red);color:#fff;background:var(--brand-red)}
    .board{border:1px solid var(--border);border-radius:14px;padding:12px;margin:10px 0;background:#fff}
    .board .board-head{display:flex;align-items:center;gap:8px;justify-content:space-between;margin-bottom:8px}
    .board .del{background:#f1f2f5}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <img src="logo.png" alt="Telefire logo" onerror="this.style.display='none'">
        <div class="title">Telefire</div>
      </div>
      <div class="badge">בקשת הצעת מחיר</div>
    </header>

    <div class="card">
      <form id="rfqForm" action="https://hook.eu2.make.com/qeec8sdrvoxa932ipvr8bm7tv41rlp8n" method="POST">
        <h1>פרטי טופס</h1>

        <h2>פרטי הלקוח</h2>
        <div class="grid">
          <div class="col-3"><label class="required">שם הטכנאי</label><input name="שם הטכנאי" required></div>
          <div class="col-3"><label class="required">שם הלקוח</label><input name="שם הלקוח" required></div>
          <div class="col-3"><label>מספר רכזת</label><input name="מספר רכזת"></div>
          <div class="col-3"><label>שם בסיס</label><input name="שם בסיס"></div>

          <div class="col-6"><label>מקום באתר</label><input name="מקום באתר"></div>
          <div class="col-6"><label>מקום בבסיס</label><input name="מקום בבסיס"></div>

          <div class="col-6"><label>איש קשר לקריאה</label><input name="איש קשר לקריאה"></div>
          <div class="col-6"><label>כתובת לקריאה</label><input name="כתובת לקריאה"></div>

          <div class="col-12"><label>מהות העבודה</label><textarea name="מהות העבודה"></textarea></div>
          <div class="col-12"><label>נתוני לוח החשמל</label><textarea name="נתוני לוח החשמל"></textarea></div>
        </div>

        <h2>פרטים ברכזת</h2>
        <div class="grid">
          <div class="col-3"><label>פנל</label><input name="פנל"></div>
          <div class="col-3"><label>לולאה</label><input name="לולאה"></div>
          <div class="col-3"><label>כמות כתובות נדרשות</label><input type="number" id="reqAddr" name="כמות כתובות נדרשות" min="0"></div>
          <div class="col-3"><label>כמות כתובות פנויות בלולאה</label><input type="number" id="freeAddr" name="כמות כתובות פנויות בלולאה" min="0"></div>
          <div class="col-12"><div id="addrWarn" class="muted" style="color:#b91c1c;display:none">כמות כתובות נדרשות לא יכולה להיות גדולה מכמות הכתובות הפנויות בלולאה.</div></div>
        </div>

        <h2>תשתית</h2>
        <div class="grid">
          <div class="col-6">
            <label>האם נדרשת הכנת תשתית</label>
            <select name="האם נדרשת הכנת תשתית">
              <option value="">בחר</option><option>כן</option><option>לא</option>
              <option>תשתית קיימת או תוכן ע״י הלקוח</option><option>קיימת תשתית חלקית יש להשלים</option>
            </select>
          </div>
          <div class="col-6"><label>אורך התשתית שנדרש להכין (מ׳)</label><input type="number" name="אורך התשתית" min="0" step="0.1"></div>
          <div class="col-6">
            <label>סוג כבל</label>
            <select name="סוג כבל">
              <option value="">בחר</option><option>NYY</option><option>2 גיד</option><option>4 גיד</option><option>רב-גידי</option>
            </select>
          </div>
          <div class="col-12">
            <label>מעביר כבל</label>
            <div class="checkboxes">
              <label class="chip"><input type="checkbox" name="מעביר כבל[]" value="מריכף"> מריכף</label>
              <label class="chip"><input type="checkbox" name="מעביר כבל[]" value="מרירון"> מרירון</label>
              <label class="chip"><input type="checkbox" name="מעביר כבל[]" value="תעלת אצבע"> תעלת אצבע</label>
              <label class="chip"><input type="checkbox" name="מעביר כבל[]" value="תעלה כפולה"> תעלה כפולה</label>
            </div>
          </div>

          <div class="col-3">
            <label>קיים V24</label>
            <div class="yn">
              <input type="radio" id="v24y" name="קיים V24" value="כן"><label for="v24y">כן</label>
              <input type="radio" id="v24n" name="קיים V24" value="לא"><label for="v24n">לא</label>
            </div>
          </div>
          <div class="col-3">
            <label>נדרש הוספת ספק</label>
            <div class="yn">
              <input type="radio" id="psuy" name="נדרש הוספת ספק" value="כן"><label for="psuy">כן</label>
              <input type="radio" id="psun" name="נדרש הוספת ספק" value="לא"><label for="psun">לא</label>
            </div>
          </div>
        </div>

        <h2>נתוני לוח החשמל</h2>
        <div id="boards"></div>
        <div class="actions"><button type="button" class="ghost" id="addBoardBtn">הוסף לוח</button></div>

        <h2>נתוני כיבוי בחדר או חלל</h2>
        <div class="board">
          <div class="muted" style="margin-bottom:6px">מידות</div>
          <table class="responsive" aria-label="נתוני כיבוי – מידות">
            <thead><tr><th>רוחב (מ״מ)</th><th>גובה (מ״מ)</th><th>עומק (מ״מ)</th></tr></thead>
            <tbody>
              <tr>
                <td data-label="רוחב (מ״מ)"><input type="number" name="כיבוי_רוחב" min="0"></td>
                <td data-label="גובה (מ״מ)"><input type="number" name="כיבוי_גובה" min="0"></td>
                <td data-label="עומק (מ״מ)"><input type="number" name="כיבוי_עומק" min="0"></td>
              </tr>
            </tbody>
          </table>
          <div class="grid">
            <div class="col-12"><label>הערות</label><textarea name="כיבוי_הערות"></textarea></div>
          </div>
        </div>

        <h2>אביזרים נדרשים להצעה</h2>
        <p class="muted">אביזר, כמות, הערה.</p>
        <table id="itemsTable" class="responsive" aria-label="אביזרים">
          <thead><tr><th>אביזר</th><th>כמות</th><th>הערה</th><th>מחיקה</th></tr></thead>
          <tbody></tbody>
        </table>
        <div class="actions"><button type="button" class="ghost" onclick="addItemRow()">הוסף שורה</button></div>

        <h2>תנאי שטח</h2>
        <div class="grid">
          <div class="col-4"><label>גובה ההתקנה (מ׳)</label><input type="number" name="גובה התקנה" min="0" step="0.1"></div>
          <div class="col-4">
            <label>התקנה בגובה</label>
            <div class="yn">
              <input type="radio" id="highy" name="התקנה בגובה" value="כן"><label for="highy">כן</label>
              <input type="radio" id="highn" name="התקנה בגובה" value="לא"><label for="highn">לא</label>
            </div>
          </div>
          <div class="col-4">
            <label>במת הרמה</label>
            <div class="yn">
              <input type="radio" id="platfy" name="במת הרמה" value="כן"><label for="platfy">כן</label>
              <input type="radio" id="platfn" name="במת הרמה" value="לא"><label for="platfn">לא</label>
            </div>
          </div>
          <div class="col-12"><label>תנאי שטח נוספים</label><textarea name="תנאי שטח נוספים"></textarea></div>
        </div>

        <h2>הערות כלליות</h2>
        <textarea name="הערות כלליות"></textarea>

        <div class="actions">
          <button type="submit" class="primary">שלח</button>
          <button type="reset" class="ghost">נקה טופס</button>
        </div>

        <p class="footer">העלה `logo.png` ו־`background.png` לשורש הריפו ללוגו ורקע.</p>
      </form>
    </div>
  </div>

  <script>
    /* אביזרים: הוספת AKSA PRO */
    const ACCESSORIES=[
      "","גלאי","בסיס","הגבהה","לחצן אדום","לחצן צהוב","לחצן אדום מוגן מים",
      "כרטיס 723","כרטיס 741","כרטיס 705","כרטיס 805","מנורת סימון","קופסת כרטיסים",
      "קופסת חיבורים","כובע לגלאי בלוח","FLAP","צופר חיצוני","צופר פנימי",
      "רמקול שקוע","רמקול ירח","שופר","פנל משנה","AKSA PRO","אחר"
    ];
    function accessorySelect(name){const sel=document.createElement('select');sel.name=name;for(const opt of ACCESSORIES){const o=document.createElement('option');o.value=opt;o.textContent=opt;sel.appendChild(o)}return sel}

    function addItemRow(){
      const tbody=document.querySelector('#itemsTable tbody'); const tr=document.createElement('tr');
      const td1=document.createElement('td'); td1.setAttribute('data-label','אביזר'); td1.appendChild(accessorySelect('אביזר[]'));
      const td2=document.createElement('td'); td2.setAttribute('data-label','כמות'); const qty=document.createElement('input'); qty.type='number'; qty.min='0'; qty.name='כמות[]'; td2.appendChild(qty);
      const td3=document.createElement('td'); td3.setAttribute('data-label','הערה'); const note=document.createElement('input'); note.type='text'; note.name='הערה[]'; td3.appendChild(note);
      const td4=document.createElement('td'); td4.setAttribute('data-label','מחיקה'); const del=document.createElement('button'); del.type='button'; del.textContent='מחיקה'; del.onclick=()=>tr.remove(); td4.appendChild(del);
      tr.append(td1,td2,td3,td4); tbody.appendChild(tr);
    }

    /* לוחות חשמל: שם לוח, טבלת מידות, ושדות מחוץ לטבלה. הסרה: "מתחת ללוח". שינוי תווית "מספר נחירים". */
    let boardIdx=0;
    function ynGroup(name, idBase){
      const wrap=document.createElement('div'); wrap.className='yn';
      const y=document.createElement('input'); y.type='radio'; y.id=idBase+'y'; y.name=name; y.value='כן';
      const yl=document.createElement('label'); yl.htmlFor=y.id; yl.textContent='כן';
      const n=document.createElement('input'); n.type='radio'; n.id=idBase+'n'; n.name=name; n.value='לא';
      const nl=document.createElement('label'); nl.htmlFor=n.id; nl.textContent='לא';
      wrap.append(y,yl,n,nl); return wrap;
    }
    function addBoard(){
      boardIdx++;
      const wrap=document.createElement('section'); wrap.className='board';
      wrap.innerHTML = `
        <div class="board-head">
          <strong>לוח ${boardIdx}</strong>
          <button type="button" class="del" aria-label="מחיקת לוח">מחק לוח</button>
        </div>

        <div class="grid">
          <div class="col-6"><label>שם הלוח</label><input name="לוח_${boardIdx}_שם"></div>
        </div>

        <div class="muted" style="margin:8px 0 6px">טבלה 2 – מידות</div>
        <table class="responsive" aria-label="טבלה 2 – מידות">
          <thead><tr><th>רוחב (מ״מ)</th><th>גובה (מ״מ)</th><th>עומק (מ״מ)</th></tr></thead>
          <tbody>
            <tr>
              <td data-label="רוחב (מ״מ)"><input type="number" name="לוח_${boardIdx}_רוחב" min="0"></td>
              <td data-label="גובה (מ״מ)"><input type="number" name="לוח_${boardIdx}_גובה" min="0"></td>
              <td data-label="עומק (מ״מ)"><input type="number" name="לוח_${boardIdx}_עומק" min="0"></td>
            </tr>
          </tbody>
        </table>

        <div class="grid" style="margin-top:8px">
          <div class="col-3"><label>מחורץ</label><div id="g_${boardIdx}_groove" class="yn"></div></div>
          <div class="col-3"><label>אטום</label><div id="g_${boardIdx}_seal" class="yn"></div></div>
          <div class="col-3"><label>מחיצות בנפרד</label><div id="g_${boardIdx}_parts_sep" class="yn"></div></div>
          <div class="col-3"><label>מחיצות צמודות אחת לשנייה</label><div id="g_${boardIdx}_parts_adj" class="yn"></div></div>

          <div class="col-3"><label>מספר נחירים</label><input type="number" name="לוח_${boardIdx}_נחירים" min="0"></div>

          <div class="col-6"><label>מיקומי מחיצות</label><input name="לוח_${boardIdx}_מיקומי_מחיצות"></div>
          <div class="col-12"><label>הערות</label><input name="לוח_${boardIdx}_הערות"></div>
        </div>
      `;
      // כן/לא
      wrap.querySelector('#g_'+boardIdx+'_groove').appendChild(ynGroup('לוח_'+boardIdx+'_מחורץ','groove'+boardIdx));
      wrap.querySelector('#g_'+boardIdx+'_seal').appendChild(ynGroup('לוח_'+boardIdx+'_אטום','seal'+boardIdx));
      wrap.querySelector('#g_'+boardIdx+'_parts_sep').appendChild(ynGroup('לוח_'+boardIdx+'_מחיצות_בנפרד','partssep'+boardIdx));
      wrap.querySelector('#g_'+boardIdx+'_parts_adj').appendChild(ynGroup('לוח_'+boardIdx+'_מחיצות_צמודות','partsadj'+boardIdx));

      wrap.querySelector('.del').onclick=()=>wrap.remove();
      document.getElementById('boards').appendChild(wrap);
    }
    document.getElementById('addBoardBtn').addEventListener('click', addBoard);

    /* ולידציה: "כתובות נדרשות" ≤ "כתובות פנויות בלולאה" */
    const reqAddr=document.getElementById('reqAddr');
    const freeAddr=document.getElementById('freeAddr');
    const addrWarn=document.getElementById('addrWarn');
    function checkAddr(){
      const r=Number(reqAddr.value||0), f=Number(freeAddr.value||0);
      const bad = r>f && f>0;
      addrWarn.style.display = bad ? 'block' : 'none';
      return !bad;
    }
    reqAddr.addEventListener('input',checkAddr);
    freeAddr.addEventListener('input',checkAddr);

    /* שורות התחלה */
    addBoard();
    (function firstItem(){ addItemRow(); })();

    /* מניעת שליחה אם יש שגיאת כתובות וחובה מינימלית */
    document.getElementById('rfqForm').addEventListener('submit',e=>{
      const tech=e.target.querySelector('input[name="שם הטכנאי"]');
      const client=e.target.querySelector('input[name="שם הלקוח"]');
      if(!tech.value.trim()||!client.value.trim()){ alert('שם הטכנאי ושם הלקוח הם שדות חובה.'); e.preventDefault(); return; }
      if(!checkAddr()){ e.preventDefault(); alert('כמות כתובות נדרשות לא יכולה להיות גדולה מכמות הכתובות הפנויות בלולאה.'); }
    });
  </script>
</body>
</html>
